<!DOCTYPE html><html lang="en" class="no-js"><head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../../06c-monitor-data-warehouse/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>Instructions - MS Fabric Labs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lab-06-analyse-data-in-a-data-warehouse" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="MS Fabric Labs" class="md-header__button md-logo" aria-label="MS Fabric Labs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3C7.58 3 4 4.79 4 7s3.58 4 8 4 8-1.79 8-4-3.58-4-8-4M4 9v3c0 2.21 3.58 4 8 4s8-1.79 8-4V9c0 2.21-3.58 4-8 4s-8-1.79-8-4m0 5v3c0 2.21 3.58 4 8 4s8-1.79 8-4v-3c0 2.21-3.58 4-8 4s-8-1.79-8-4"></path></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MS Fabric Labs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Instructions
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="MS Fabric Labs" class="md-nav__button md-logo" aria-label="MS Fabric Labs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3C7.58 3 4 4.79 4 7s3.58 4 8 4 8-1.79 8-4-3.58-4-8-4M4 9v3c0 2.21 3.58 4 8 4s8-1.79 8-4V9c0 2.21-3.58 4-8 4s-8-1.79-8-4m0 5v3c0 2.21 3.58 4 8 4s8-1.79 8-4v-3c0 2.21-3.58 4-8 4s-8-1.79-8-4"></path></svg>

    </a>
    MS Fabric Labs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Microsoft Fabric
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Microsoft Fabric
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../01-lakehouse/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    01 Lakehouse
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            01 Lakehouse
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01-lakehouse/instructions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Instructions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../03b-medallion-lakehouse/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    3b Medallion Architecture
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            3b Medallion Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03b-medallion-lakehouse/instructions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Instructions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../04-ingest-pipeline/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    04 Ingest Pipeline
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            04 Ingest Pipeline
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04-ingest-pipeline/instructions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Instructions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../05-dataflows-gen2/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    05 Dataflows (Gen2)
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            05 Dataflows (Gen2)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05-dataflows-gen2/instructions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Instructions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    06 Analyse data in a data warehouse
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            06 Analyse data in a data warehouse
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Instructions
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Instructions
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-1-signing-in-to-microsoft-fabric" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Signing in to Microsoft Fabric
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-create-a-workspace" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Create a workspace
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-create-a-data-warehouse" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Create a data warehouse
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-create-tables-and-insert-data" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Create tables and insert data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-query-data-warehouse-tables" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: Query data warehouse tables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-create-a-view" class="md-nav__link">
    <span class="md-ellipsis">
      Step 6: Create a view
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-7-create-a-visual-query" class="md-nav__link">
    <span class="md-ellipsis">
      Step 7: Create a visual query
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-8-define-a-data-model-optional" class="md-nav__link">
    <span class="md-ellipsis">
      Step 8: Define a data model (optional)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-9-create-relationships" class="md-nav__link">
    <span class="md-ellipsis">
      Step 9: Create relationships
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clean-up-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Clean up resources
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../06c-monitor-data-warehouse/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    06c Monitor Data Warehouse
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            06c Monitor Data Warehouse
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../06c-monitor-data-warehouse/instructions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Instructions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../09-real-time-analytics-eventstream/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    09 Real-time Eventstream
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            09 Real-time Eventstream
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../09-real-time-analytics-eventstream/instructions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Instructions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../18-monitor-hub/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    18 Monitor Hub
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            18 Monitor Hub
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../18-monitor-hub/instructions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Instructions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_9">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../19-secure-data-access/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    19 Secure Data Access
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_9" id="__nav_2_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_9">
            <span class="md-nav__icon md-icon"></span>
            19 Secure Data Access
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../19-secure-data-access/instructions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Instructions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_10">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../20-work-with-database/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    20 Work with SQL Database
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_10" id="__nav_2_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_10">
            <span class="md-nav__icon md-icon"></span>
            20 Work with SQL Database
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../20-work-with-database/instructions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Instructions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_11">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../21-deployment-pipelines/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    21 Deployment Pipelines
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_11" id="__nav_2_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_11">
            <span class="md-nav__icon md-icon"></span>
            21 Deployment Pipelines
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../21-deployment-pipelines/instructions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Instructions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="lab-06-analyse-data-in-a-data-warehouse">Lab 06 ~ Analyse data in a data warehouse</h1>
<div class="admonition info">
<p class="admonition-title">For this lab you need to navigate to QA Platform and login using the credentials provided</p>
</div>
<div class="admonition warning">
<p class="admonition-title">It is important that you use an incognito/private mode browser tab and not your work or personal Microsoft login</p>
</div>
<h2 id="step-1-signing-in-to-microsoft-fabric">Step 1: Signing in to Microsoft Fabric</h2>
<p>In this lab, you will sign in to Microsoft Fabric using the email and password from the QA Platform.</p>
<ol>
<li>
<p>Using an <strong>incognito/private mode browser tab</strong> navigate to the <a href="https://app.fabric.microsoft.com/">Fabric portal</a> at: <a href="https://fabric.microsoft.com">https://fabric.microsoft.com</a></p>
</li>
<li>
<p>Follow the prompts, and sign in with the user credentials from the QA Platform:</p>
<ul>
<li>Email</li>
<li>Password</li>
</ul>
<p>After signing in, you will be redirected to the Fabric home page:</p>
<div class="admonition quote">
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../img/qa-fabric-home.png" data-desc-position="bottom"><img alt="Fabric home page" src="../../img/qa-fabric-home.png"></a></p>
</div>
</li>
</ol>
<h2 id="step-2-create-a-workspace">Step 2: Create a workspace</h2>
<p>Before working with data in Fabric, you need to create a workspace with a Fabric licence capacity.</p>
<ol>
<li>
<p>Navigate to the <a href="https://app.fabric.microsoft.com/home?experience=fabric">Microsoft Fabric home page</a> in an incognito/private mode browser tab browser, and sign in with the Fabric credentials from the QA Platform.</p>
</li>
<li>
<p>In the menu bar on the left, select Workspaces (the icon looks similar to ðŸ—‡).</p>
</li>
<li>
<p>Create a <strong>New workspace</strong>:</p>
<ul>
<li>Give it a unique name. For example: <code>fab_workspace123</code></li>
<li>Leave all other options as the default values</li>
<li>Click <strong>Apply</strong></li>
</ul>
</li>
<li>
<p>When your new workspace opens, it should be empty.</p>
<div class="admonition quote">
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../img/new-workspace.png" data-desc-position="bottom"><img alt="Screenshot of an empty workspace in Fabric." src="../../img/new-workspace.png"></a></p>
</div>
</li>
</ol>
<h2 id="step-3-create-a-data-warehouse">Step 3: Create a data warehouse</h2>
<p><em>Now that you have a workspace, it's time to create a data warehouse.</em></p>
<ol>
<li>
<p>On the menu bar on the left, select <strong>Create</strong>. In the <em>New</em> page, under the <em>Data Warehouse</em> section, select <strong>Warehouse</strong>. </p>
<p>Give it a name of your choice. For example: <code>fab_warehouse</code></p>
<div class="admonition tip">
<p class="admonition-title">If the <strong>Create</strong> option is not pinned to the sidebar, you need to select the ellipsis (â€¦) option first.</p>
</div>
<p>After a minute or so, a new warehouse will be created:</p>
<div class="admonition quote">
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../img/06-new-data-warehouse.png" data-desc-position="bottom"><img alt="Screenshot of a new warehouse." src="../../img/06-new-data-warehouse.png"></a></p>
</div>
</li>
</ol>
<h2 id="step-4-create-tables-and-insert-data">Step 4: Create tables and insert data</h2>
<p><em>A warehouse is a relational database in which you can define tables and other objects.</em></p>
<ol>
<li>
<p>In your new warehouse, select the <strong>T-SQL</strong> tile, and add the following CREATE TABLE statement:</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">dbo</span><span class="p">.</span><span class="n">DimProduct</span>
<span class="p">(</span>
<span class="w">   </span><span class="n">ProductKey</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">   </span><span class="n">ProductAltKey</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">   </span><span class="n">ProductName</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">   </span><span class="n">Category</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">   </span><span class="n">ListPrice</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">NULL</span>
<span class="p">);</span>
<span class="k">GO</span>
</code></pre></div>
</li>
<li>
<p>Use the  <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 5.14v14l11-7z"></path></svg></span> <strong>Run</strong> button to run the SQL script, which creates a new table named <strong>DimProduct</strong> in the <strong>dbo</strong> schema of the data warehouse.</p>
</li>
<li>
<p>Use the <strong>Refresh</strong> button next to your warehouse name to refresh the display. Then, in the <strong>Explorer</strong> pane, expand <strong>Schemas</strong> &gt; <strong>dbo</strong> &gt; <strong>Tables</strong> and verify that the <strong>DimProduct</strong> table has been created.</p>
</li>
<li>
<p>On the <strong>Home</strong> menu tab, use the <strong>New SQL Query</strong> button to create a new query, and enter the following INSERT statement:</p>
<div class="highlight"><pre><span></span><code><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">dbo</span><span class="p">.</span><span class="n">DimProduct</span>
<span class="k">VALUES</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">'RING1'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Bicycle bell'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Accessories'</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">.</span><span class="mi">99</span><span class="p">),</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">'BRITE1'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Front light'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Accessories'</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">.</span><span class="mi">49</span><span class="p">),</span>
<span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">'BRITE2'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Rear light'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Accessories'</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">.</span><span class="mi">49</span><span class="p">);</span>
<span class="k">GO</span>
</code></pre></div>
</li>
<li>
<p>Run the new query to insert three rows into the <strong>DimProduct</strong> table.</p>
</li>
<li>
<p>When the query has finished, in the <strong>Explorer</strong> pane, select the <strong>DimProduct</strong> table and verify that the three rows have been added to the table.</p>
</li>
<li>
<p>On the <strong>Home</strong> menu tab, use the <strong>New SQL Query</strong> button to create a new query. Then copy and paste the Transact-SQL code from <a href="https://raw.githubusercontent.com/MicrosoftLearning/dp-data/main/create-dw.txt">https://raw.githubusercontent.com/MicrosoftLearning/dp-data/main/create-dw.txt</a> into the new query pane.</p>
</li>
<li>
<p>Run the query, which creates a simple data warehouse schema and loads some data. The script should take around 30 seconds to run.</p>
</li>
<li>
<p>Use the <strong>Refresh</strong> button next to your warehouse name to refresh the display. Then in the <strong>Explorer</strong> pane, verify that the <strong>dbo</strong> schema in the data warehouse now contains the following four tables:</p>
<ul>
<li><strong>DimCustomer</strong></li>
<li><strong>DimDate</strong></li>
<li><strong>DimProduct</strong></li>
<li><strong>FactSalesOrder</strong></li>
</ul>
</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">If the schema takes a while to load, just refresh the browser page.</p>
</div>
<h2 id="step-5-query-data-warehouse-tables">Step 5: Query data warehouse tables</h2>
<p><em>Since the data warehouse is a relational database, you can use SQL to query its tables.</em></p>
<h3 id="query-fact-and-dimension-tables">Query fact and dimension tables</h3>
<p>Most queries in a relational data warehouse involve aggregating and grouping data (using aggregate functions and GROUP BY clauses) across related tables (using JOIN clauses).</p>
<ol>
<li>
<p>Navigate back to the browser tab with your warehouse and create a new SQL Query, and <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 5.14v14l11-7z"></path></svg></span> <strong>Run</strong> the following code:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="n">d</span><span class="p">.[</span><span class="k">Year</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">CalendarYear</span><span class="p">,</span>
<span class="w">       </span><span class="n">d</span><span class="p">.[</span><span class="k">Month</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">MonthOfYear</span><span class="p">,</span>
<span class="w">       </span><span class="n">d</span><span class="p">.</span><span class="n">MonthName</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">MonthName</span><span class="p">,</span>
<span class="w">       </span><span class="k">SUM</span><span class="p">(</span><span class="n">so</span><span class="p">.</span><span class="n">SalesTotal</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">SalesRevenue</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">FactSalesOrder</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">so</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">DimDate</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">so</span><span class="p">.</span><span class="n">SalesOrderDateKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">DateKey</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">d</span><span class="p">.[</span><span class="k">Year</span><span class="p">],</span><span class="w"> </span><span class="n">d</span><span class="p">.[</span><span class="k">Month</span><span class="p">],</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">MonthName</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">CalendarYear</span><span class="p">,</span><span class="w"> </span><span class="n">MonthOfYear</span><span class="p">;</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The attributes in the date dimension enable you to aggregate the measures in the fact table at multiple hierarchical levels - in this case, year and month. This is a common pattern in data warehouses.</p>
</div>
</li>
<li>
<p>Modify the query as follows to add a second dimension to the aggregation.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="n">d</span><span class="p">.[</span><span class="k">Year</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">CalendarYear</span><span class="p">,</span>
<span class="w">       </span><span class="n">d</span><span class="p">.[</span><span class="k">Month</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">MonthOfYear</span><span class="p">,</span>
<span class="w">       </span><span class="n">d</span><span class="p">.</span><span class="n">MonthName</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">MonthName</span><span class="p">,</span>
<span class="w">       </span><span class="k">c</span><span class="p">.</span><span class="n">CountryRegion</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">SalesRegion</span><span class="p">,</span>
<span class="w">       </span><span class="k">SUM</span><span class="p">(</span><span class="n">so</span><span class="p">.</span><span class="n">SalesTotal</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">SalesRevenue</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">FactSalesOrder</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">so</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">DimDate</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">so</span><span class="p">.</span><span class="n">SalesOrderDateKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">DateKey</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">DimCustomer</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">c</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">so</span><span class="p">.</span><span class="n">CustomerKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">CustomerKey</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">d</span><span class="p">.[</span><span class="k">Year</span><span class="p">],</span><span class="w"> </span><span class="n">d</span><span class="p">.[</span><span class="k">Month</span><span class="p">],</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">MonthName</span><span class="p">,</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">CountryRegion</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">CalendarYear</span><span class="p">,</span><span class="w"> </span><span class="n">MonthOfYear</span><span class="p">,</span><span class="w"> </span><span class="n">SalesRegion</span><span class="p">;</span>
</code></pre></div>
</li>
<li>
<p>Run the modified query and review the results, which now include sales revenue aggregated by year, month, and sales region.</p>
</li>
</ol>
<h2 id="step-6-create-a-view">Step 6: Create a view</h2>
<p>A data warehouse in Microsoft Fabric has many of the same capabilities you may be used to in relational databases. For example, you can create database objects like <em>views</em> and <em>stored procedures</em> to encapsulate SQL logic.</p>
<ol>
<li>
<p>Modify the query you created previously as follows to create a view (note that you need to remove the ORDER BY clause to create a view).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">VIEW</span><span class="w"> </span><span class="n">vSalesByRegion</span>
<span class="k">AS</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">d</span><span class="p">.[</span><span class="k">Year</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">CalendarYear</span><span class="p">,</span>
<span class="w">       </span><span class="n">d</span><span class="p">.[</span><span class="k">Month</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">MonthOfYear</span><span class="p">,</span>
<span class="w">       </span><span class="n">d</span><span class="p">.</span><span class="n">MonthName</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">MonthName</span><span class="p">,</span>
<span class="w">       </span><span class="k">c</span><span class="p">.</span><span class="n">CountryRegion</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">SalesRegion</span><span class="p">,</span>
<span class="w">       </span><span class="k">SUM</span><span class="p">(</span><span class="n">so</span><span class="p">.</span><span class="n">SalesTotal</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">SalesRevenue</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">FactSalesOrder</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">so</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">DimDate</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">so</span><span class="p">.</span><span class="n">SalesOrderDateKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">DateKey</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">DimCustomer</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">c</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">so</span><span class="p">.</span><span class="n">CustomerKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">CustomerKey</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">d</span><span class="p">.[</span><span class="k">Year</span><span class="p">],</span><span class="w"> </span><span class="n">d</span><span class="p">.[</span><span class="k">Month</span><span class="p">],</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">MonthName</span><span class="p">,</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">CountryRegion</span><span class="p">;</span>
</code></pre></div>
</li>
<li>
<p>Run the query to create the view.</p>
<div class="admonition success">
<p class="admonition-title">Refresh the data warehouse schema and verify that the new view is listed in the <strong>Explorer</strong> pane.</p>
</div>
</li>
<li>
<p>Create a new SQL query and <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 5.14v14l11-7z"></path></svg></span> <strong>Run</strong> the following SELECT statement:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="n">CalendarYear</span><span class="p">,</span><span class="w"> </span><span class="n">MonthName</span><span class="p">,</span><span class="w"> </span><span class="n">SalesRegion</span><span class="p">,</span><span class="w"> </span><span class="n">SalesRevenue</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">vSalesByRegion</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">CalendarYear</span><span class="p">,</span><span class="w"> </span><span class="n">MonthOfYear</span><span class="p">,</span><span class="w"> </span><span class="n">SalesRegion</span><span class="p">;</span>
</code></pre></div>
</li>
</ol>
<h2 id="step-7-create-a-visual-query">Step 7: Create a visual query</h2>
<p>Instead of writing SQL code, you can use the graphical query designer to query the tables in your data warehouse. This experience is similar to Power Query online, where you can create data transformation steps with no code. For more complex tasks, you can use Power Query's M (Mashup) language.</p>
<ol>
<li>
<p>On the <strong>Home</strong> menu, expand the options under <strong>New SQL query</strong> and select <strong>New visual query</strong>.</p>
</li>
<li>
<p>Drag <strong>FactSalesOrder</strong> onto the <strong>canvas</strong>. Notice that a preview of the table is displayed in the <strong>Preview</strong> pane below.</p>
</li>
<li>
<p>Drag <strong>DimProduct</strong> onto the <strong>canvas</strong>. We now have two tables in our query.</p>
</li>
<li>
<p>Select the <strong>FactSalesOrder</strong> box, and click the <strong>(+)</strong> button on the canvas to <strong>Merge queries</strong>.</p>
<div class="admonition quote">
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../img/06-visual-query-merge.png" data-desc-position="bottom"><img alt="Canvas with the FactSalesOrder table selected." src="../../img/06-visual-query-merge.png"></a></p>
</div>
</li>
<li>
<p>In the <strong>Merge queries</strong> window, select <strong>DimProduct</strong> as the right table for merge. Select <strong>ProductKey</strong> in both queries, leave the default <strong>Left outer</strong> join type, and click <strong>OK</strong>.</p>
<div class="admonition quote">
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../img/06-dw-merge.png" data-desc-position="bottom"><img alt="Merge options." src="../../img/06-dw-merge.png"></a></p>
</div>
</li>
<li>
<p>In the <strong>Preview</strong>, note that the new <strong>DimProduct</strong> column has been added to the FactSalesOrder table. Expand the column by clicking the arrow to the right of the column name. Select <strong>ProductName</strong> and click <strong>OK</strong>.</p>
<div class="admonition quote">
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../img/06-visual-query-preview.png" data-desc-position="bottom"><img alt="preview pane with the DimProduct column expanded, ProductName selected." src="../../img/06-visual-query-preview.png"></a></p>
</div>
</li>
<li>
<p>If you're interested in looking at data for a single product, per a manager request, you can now use the <strong>ProductName</strong> column to filter the data in the query. Filter the <strong>ProductName</strong> column to look at <strong>Cable Lock</strong> data only.</p>
</li>
<li>
<p>From here, you can analyse the results of this single query by selecting <strong>Visualize results</strong> or <strong>Download Excel file</strong>. You can now see exactly what the manager was asking for, so we don't need to analyse the results further.</p>
</li>
</ol>
<h2 id="step-8-define-a-data-model-optional">Step 8: Define a data model (optional)</h2>
<p>A relational data warehouse typically consists of <em>fact</em> and <em>dimension</em> tables. The fact tables contain numeric measures you can aggregate to analyse business performance (for example, sales revenue), and the dimension tables contain attributes of the entities by which you can aggregate the data (for example, product, customer, or time). In a Microsoft Fabric data warehouse, you can use these keys to define a data model that encapsulates the relationships between the tables.</p>
<ol>
<li>
<p>In the toolbar, select <strong>New semantic model</strong>.</p>
</li>
<li>
<p>In the <strong>New semantic model</strong> window, name the semantic model and select all four tables. Select <strong>Confirm</strong>.</p>
</li>
<li>
<p>A new browser tab will automatically open with your new semantic model. In the model pane, rearrange the tables in your data warehouse so that the <strong>FactSalesOrder</strong> table is in the middle, like this:</p>
<div class="admonition note">
<p class="admonition-title">If your model doesn't open automatically:</p>
<ul>
<li>Click your workspace</li>
<li>Then select the semantic model</li>
<li>Then: open semantic model</li>
</ul>
</div>
<div class="admonition quote">
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../img/06-model-dw.png" data-desc-position="bottom"><img alt="Screenshot of the data warehouse model page." src="../../img/06-model-dw.png"></a></p>
</div>
</li>
</ol>
<hr>
<div class="admonition warning">
<p class="admonition-title">You need a Power BI license to create and edit semantic models.</p>
</div>
<p>To get a PowerBi licence do the following:</p>
<div class="codehilite"><pre><span></span><code>- Click your workspace
- Next to your semantic model click the ... 
- Select: Create report
- You should now be offered a 60-day trial for PowerBi
</code></pre></div>

<h2 id="step-9-create-relationships">Step 9: Create relationships</h2>
<div class="admonition note">
<p class="admonition-title">Make sure that you are in Editing mode and not Viewing mode</p>
</div>
<ol>
<li>
<p>Drag the <strong>ProductKey</strong> field from the <strong>FactSalesOrder</strong> table and drop it on the <strong>ProductKey</strong> field in the <strong>DimProduct</strong> table. Then confirm the following relationship details:</p>
<ul>
<li><strong>From table</strong>: FactSalesOrder</li>
<li><strong>Column</strong>: ProductKey</li>
<li><strong>To table</strong>: DimProduct</li>
<li><strong>Column</strong>: ProductKey</li>
<li><strong>Cardinality</strong>: Many to one (*:1)</li>
<li><strong>Cross filter direction</strong>: Single</li>
<li><strong>Make this relationship active</strong>: Selected</li>
<li><strong>Assume referential integrity</strong>: Unselected</li>
</ul>
</li>
<li>
<p>Repeat the process to create many-to-one relationships between the following tables:</p>
<ul>
<li><strong>FactSalesOrder.CustomerKey</strong> â†’ <strong>DimCustomer.CustomerKey</strong></li>
<li><strong>FactSalesOrder.SalesOrderDateKey</strong> â†’ <strong>DimDate.DateKey</strong></li>
</ul>
<p>When all of the relationships have been defined, the model should look like this:</p>
<div class="admonition quote">
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../img/06-dw-relationships.png" data-desc-position="bottom"><img alt="Screenshot of the model with relationships." src="../../img/06-dw-relationships.png"></a></p>
</div>
</li>
<li>
<p>Now go back to your semantic model in your workspace and click: <strong>Auto-create report</strong></p>
<div class="admonition quote">
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../img/06-powerbi-report.png" data-desc-position="bottom"><img alt="PowerBi Report." src="../../img/06-powerbi-report.png"></a></p>
</div>
</li>
</ol>
<hr>
<h2 id="clean-up-resources">Clean up resources</h2>
<p>In this exercise, you have created a data warehouse that contains multiple tables. You used SQL to insert data into the tables and queried tables using T-SQL and the visual query tool. Finally, you enhanced the data model for the data warehouse's default dataset for downstream analytics and reporting.</p>
<p>If you've finished exploring your data warehouse, you should delete the workspace you created for this exercise.</p>
<ol>
<li>
<p>Navigate to Microsoft Fabric in your browser.</p>
</li>
<li>
<p>In the bar on the left, select the icon for your workspace to view all of the items it contains.</p>
</li>
<li>
<p>Select <strong>Workspace settings</strong> and in the <strong>General</strong> section, scroll down and select <strong>Remove this workspace</strong>.</p>
</li>
<li>
<p>Select <strong>Delete</strong> to delete the workspace.</p>
</li>
</ol>
<hr>
<p><small><b>Source:
<a href="https://microsoftlearning.github.io/mslearn-fabric/Instructions/Labs/06-data-warehouse.html">https://microsoftlearning.github.io/mslearn-fabric/Instructions/Labs/06-data-warehouse.html</a>
</b></small></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["toc.integrate", "content.code.copy", "navigation.indexes"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>